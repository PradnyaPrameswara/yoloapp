{"ast":null,"code":"var _jsxFileName = \"C:\\\\Gemastik\\\\yoloapp\\\\yoloapp\\\\frontend\\\\src\\\\pages\\\\CalculatorPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useCallback, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CalculatorPage = ({\n  onNavigate\n}) => {\n  _s();\n  var _analysisResult$state2, _analysisResult$state3, _analysisResult$state4, _analysisResult$state5, _analysisResult$state6, _analysisResult$state7, _analysisResult$state8, _analysisResult$state9, _analysisResult$detec, _analysisResult$state0, _analysisResult$state1;\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const analysisIntervalRef = useRef(null);\n  const analysisTimeoutRef = useRef(null);\n  const [isCameraOn, setIsCameraOn] = useState(false);\n  const [analysisResult, setAnalysisResult] = useState({\n    detected_class: null,\n    state: {\n      current_state: \"WAIT_FIRST_NUM\",\n      number_1: null,\n      operator: null,\n      number_2: null,\n      result: null\n    }\n  });\n  const [statusMessage, setStatusMessage] = useState(\"Click 'Start Camera' to begin.\");\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [analysisTimer, setAnalysisTimer] = useState(0);\n\n  // Function to start the camera\n  const startCamera = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true\n      });\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        setIsCameraOn(true);\n        setStatusMessage(\"Please show the first number (0-9).\");\n      }\n    } catch (err) {\n      console.error(\"Error accessing camera:\", err);\n      setStatusMessage(\"Camera access denied. Please allow camera permissions.\");\n    }\n  };\n\n  // Function to stop the camera\n  const stopCamera = () => {\n    if (videoRef.current && videoRef.current.srcObject) {\n      videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      setIsCameraOn(false);\n      setStatusMessage(\"Click 'Start Camera' to begin.\");\n    }\n    // Stop any ongoing analysis\n    stopAnalysisProcess();\n  };\n\n  // Function to stop analysis process\n  const stopAnalysisProcess = () => {\n    if (analysisIntervalRef.current) {\n      clearInterval(analysisIntervalRef.current);\n      analysisIntervalRef.current = null;\n    }\n    if (analysisTimeoutRef.current) {\n      clearTimeout(analysisTimeoutRef.current);\n      analysisTimeoutRef.current = null;\n    }\n    setIsAnalyzing(false);\n    setAnalysisTimer(0);\n  };\n\n  // Function to manually reset the calculator with cache clearing\n  const resetCalculator = async () => {\n    // Stop any ongoing analysis\n    stopAnalysisProcess();\n\n    // Clear frontend cache/state\n    setAnalysisResult({\n      detected_class: null,\n      state: {\n        current_state: \"WAIT_FIRST_NUM\",\n        number_1: null,\n        operator: null,\n        number_2: null,\n        result: null\n      }\n    });\n    setStatusMessage(\"Calculator reset. Please show the first number.\");\n\n    // Clear backend cache by calling reset endpoint\n    try {\n      await fetch('http://localhost:8001/api/reset', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      console.log(\"Backend cache cleared successfully\");\n    } catch (error) {\n      console.error(\"Failed to clear backend cache:\", error);\n      // Continue with frontend reset even if backend reset fails\n    }\n  };\n\n  // Function to perform single frame analysis\n  const performSingleAnalysis = useCallback(async () => {\n    if (!videoRef.current || !videoRef.current.srcObject) return null;\n    const canvas = canvasRef.current;\n    const video = videoRef.current;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const context = canvas.getContext('2d');\n    context.drawImage(video, 0, 0, canvas.width, canvas.height);\n    return new Promise(resolve => {\n      canvas.toBlob(async blob => {\n        const formData = new FormData();\n        formData.append('file', blob, 'frame.jpg');\n        try {\n          const response = await fetch('http://localhost:8001/api/detect', {\n            method: 'POST',\n            body: formData\n          });\n          const data = await response.json();\n          resolve(data);\n        } catch (error) {\n          console.error(\"Analysis failed:\", error);\n          setStatusMessage(\"Analysis failed. Is the backend running?\");\n          resolve(null);\n        }\n      }, 'image/jpeg');\n    });\n  }, []);\n\n  // Function to run analysis for 3 seconds or until gesture detected\n  const runAnalysis = useCallback(async () => {\n    if (isAnalyzing || !isCameraOn || !videoRef.current || !videoRef.current.srcObject) return;\n    setIsAnalyzing(true);\n    setAnalysisTimer(3);\n\n    // Timer countdown display\n    const timerInterval = setInterval(() => {\n      setAnalysisTimer(prev => {\n        if (prev <= 1) {\n          clearInterval(timerInterval);\n          return 0;\n        } else {\n          return prev - 1;\n        }\n      });\n    }, 1000);\n\n    // Analysis interval - check every 500ms\n    analysisIntervalRef.current = setInterval(async () => {\n      const result = await performSingleAnalysis();\n      if (result) {\n        setAnalysisResult(result);\n\n        // Stop analysis if valid gesture is detected (not 'Undefined' or null)\n        if (result.detected_class && result.detected_class !== 'Undefined') {\n          console.log(`Valid gesture detected: ${result.detected_class}. Stopping analysis.`);\n          clearInterval(timerInterval);\n          stopAnalysisProcess();\n\n          // Handle reset when Start is detected\n          if (result.detected_class === 'Start') {\n            setTimeout(() => {\n              setAnalysisResult({\n                detected_class: null,\n                state: {\n                  current_state: \"WAIT_FIRST_NUM\",\n                  number_1: null,\n                  operator: null,\n                  number_2: null,\n                  result: null\n                }\n              });\n            }, 1500);\n          }\n          return; // Exit the interval\n        }\n      }\n    }, 500); // Check every 500ms\n\n    // Stop analysis after 3 seconds maximum\n    analysisTimeoutRef.current = setTimeout(() => {\n      console.log(\"3 seconds elapsed. Stopping analysis.\");\n      clearInterval(timerInterval);\n      stopAnalysisProcess();\n    }, 3000);\n  }, [isAnalyzing, isCameraOn, performSingleAnalysis]);\n\n  // Helper to update status message based on state\n  const updateStatusMessage = useCallback(() => {\n    const {\n      state,\n      detected_class\n    } = analysisResult;\n    if (!state) return;\n    if (detected_class === 'Start') {\n      setStatusMessage(\"System reset! Starting fresh calculation...\");\n      return;\n    }\n    if (detected_class === 'Undefined') {\n      setStatusMessage(\"Gesture not recognized. Please try again.\");\n      return;\n    }\n    switch (state.current_state) {\n      case \"WAIT_FIRST_NUM\":\n        setStatusMessage(\"Please show the first number (0-9).\");\n        break;\n      case \"WAIT_OPERATOR\":\n        setStatusMessage(`Got it: ${state.number_1}. Now show an operator.`);\n        break;\n      case \"WAIT_SECOND_NUM\":\n        setStatusMessage(`OK: ${state.number_1} ${state.operator}. Now show the second number.`);\n        break;\n      case \"SHOWING_RESULT\":\n        setStatusMessage(`Calculation complete! Result: ${state.result}. Show 'Start' to reset.`);\n        break;\n      default:\n        setStatusMessage(\"Ready to start.\");\n    }\n  }, [analysisResult]);\n  useEffect(() => {\n    updateStatusMessage();\n  }, [analysisResult, updateStatusMessage]);\n\n  // Helper to get dynamic class for UI boxes\n  const getBoxClass = boxName => {\n    var _analysisResult$state;\n    const currentState = (_analysisResult$state = analysisResult.state) === null || _analysisResult$state === void 0 ? void 0 : _analysisResult$state.current_state;\n    let isActive = false;\n    if (boxName === 'number_1' && currentState === 'WAIT_FIRST_NUM') isActive = true;\n    if (boxName === 'operator' && currentState === 'WAIT_OPERATOR') isActive = true;\n    if (boxName === 'number_2' && currentState === 'WAIT_SECOND_NUM') isActive = true;\n    return `p-4 rounded-lg transition-all text-center ${isActive ? 'active-box' : 'bg-gray-800'}`;\n  };\n\n  // Cleanup camera and intervals on component unmount\n  useEffect(() => {\n    const videoElement = videoRef.current;\n    return () => {\n      if (videoElement && videoElement.srcObject) {\n        videoElement.srcObject.getTracks().forEach(track => track.stop());\n      }\n      // Clean up intervals and timeouts\n      if (analysisIntervalRef.current) {\n        clearInterval(analysisIntervalRef.current);\n      }\n      if (analysisTimeoutRef.current) {\n        clearTimeout(analysisTimeoutRef.current);\n      }\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8 animate-fade-in\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col items-center bg-gray-800 p-6 rounded-2xl shadow-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full flex justify-between items-center mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold\",\n          children: \"YOLOv11 Calculator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onNavigate('home'),\n          className: \"text-sm text-blue-400 hover:text-blue-300\",\n          children: \"\\u2190 Back to Home\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full aspect-video bg-black rounded-lg overflow-hidden mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          autoPlay: true,\n          playsInline: true,\n          className: \"w-full h-full object-cover\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"hidden\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-wrap gap-2 justify-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: isCameraOn ? stopCamera : startCamera,\n          className: \"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors\",\n          children: isCameraOn ? 'Stop Camera' : 'Start Camera'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: runAnalysis,\n          disabled: !isCameraOn || isAnalyzing,\n          className: \"px-6 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-semibold transition-colors disabled:bg-gray-500\",\n          children: isAnalyzing ? `Analyzing... ${analysisTimer}s` : 'Run Analysis (3s)'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: resetCalculator,\n          className: \"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-colors\",\n          children: \"Reset & Clear Cache\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 17\n      }, this), isAnalyzing && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-green-500 rounded-full animate-pulse\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-green-400\",\n            children: [\"Detecting gestures... \", analysisTimer, \"s remaining\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-2 w-full bg-gray-600 rounded-full h-2\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-green-500 h-2 rounded-full transition-all duration-1000\",\n            style: {\n              width: `${(3 - analysisTimer) / 3 * 100}%`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-gray-400 mt-1\",\n          children: \"Analysis will stop when gesture is detected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col justify-center bg-gray-800 p-6 rounded-2xl shadow-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold mb-4 text-center\",\n        children: \"Calculation\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-message bg-gray-700 p-3 rounded-lg mb-6\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-lg text-center font-mono\",\n          children: statusMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"calculation-display flex items-center justify-center space-x-2 md:space-x-4 text-3xl md:text-5xl font-mono mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: getBoxClass('number_1'),\n          children: (_analysisResult$state2 = (_analysisResult$state3 = analysisResult.state) === null || _analysisResult$state3 === void 0 ? void 0 : _analysisResult$state3.number_1) !== null && _analysisResult$state2 !== void 0 ? _analysisResult$state2 : '_'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: getBoxClass('operator'),\n          children: (_analysisResult$state4 = (_analysisResult$state5 = analysisResult.state) === null || _analysisResult$state5 === void 0 ? void 0 : _analysisResult$state5.operator) !== null && _analysisResult$state4 !== void 0 ? _analysisResult$state4 : '_'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: getBoxClass('number_2'),\n          children: (_analysisResult$state6 = (_analysisResult$state7 = analysisResult.state) === null || _analysisResult$state7 === void 0 ? void 0 : _analysisResult$state7.number_2) !== null && _analysisResult$state6 !== void 0 ? _analysisResult$state6 : '_'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"mx-2\",\n          children: \"=\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"p-4 rounded-lg bg-gray-800 text-center\",\n          children: (_analysisResult$state8 = (_analysisResult$state9 = analysisResult.state) === null || _analysisResult$state9 === void 0 ? void 0 : _analysisResult$state9.result) !== null && _analysisResult$state8 !== void 0 ? _analysisResult$state8 : '_'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-700 p-3 rounded-lg text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Last Detected: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-bold text-green-400\",\n            children: (_analysisResult$detec = analysisResult.detected_class) !== null && _analysisResult$detec !== void 0 ? _analysisResult$detec : 'None'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 39\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Current State: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-bold text-yellow-400\",\n            children: (_analysisResult$state0 = (_analysisResult$state1 = analysisResult.state) === null || _analysisResult$state1 === void 0 ? void 0 : _analysisResult$state1.current_state) !== null && _analysisResult$state0 !== void 0 ? _analysisResult$state0 : 'N/A'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 39\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 254,\n    columnNumber: 9\n  }, this);\n};\n_s(CalculatorPage, \"JWs2letdUAlbBJmJ3yFBCL2ipFg=\");\n_c = CalculatorPage;\nexport default CalculatorPage;\nvar _c;\n$RefreshReg$(_c, \"CalculatorPage\");","map":{"version":3,"names":["React","useState","useRef","useCallback","useEffect","jsxDEV","_jsxDEV","CalculatorPage","onNavigate","_s","_analysisResult$state2","_analysisResult$state3","_analysisResult$state4","_analysisResult$state5","_analysisResult$state6","_analysisResult$state7","_analysisResult$state8","_analysisResult$state9","_analysisResult$detec","_analysisResult$state0","_analysisResult$state1","videoRef","canvasRef","analysisIntervalRef","analysisTimeoutRef","isCameraOn","setIsCameraOn","analysisResult","setAnalysisResult","detected_class","state","current_state","number_1","operator","number_2","result","statusMessage","setStatusMessage","isAnalyzing","setIsAnalyzing","analysisTimer","setAnalysisTimer","startCamera","stream","navigator","mediaDevices","getUserMedia","video","current","srcObject","err","console","error","stopCamera","getTracks","forEach","track","stop","stopAnalysisProcess","clearInterval","clearTimeout","resetCalculator","fetch","method","headers","log","performSingleAnalysis","canvas","width","videoWidth","height","videoHeight","context","getContext","drawImage","Promise","resolve","toBlob","blob","formData","FormData","append","response","body","data","json","runAnalysis","timerInterval","setInterval","prev","setTimeout","updateStatusMessage","getBoxClass","boxName","_analysisResult$state","currentState","isActive","videoElement","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","autoPlay","playsInline","disabled","style","_c","$RefreshReg$"],"sources":["C:/Gemastik/yoloapp/yoloapp/frontend/src/pages/CalculatorPage.js"],"sourcesContent":["import React, { useState, useRef, useCallback, useEffect } from 'react';\r\n\r\nconst CalculatorPage = ({ onNavigate }) => {\r\n    const videoRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n    const analysisIntervalRef = useRef(null);\r\n    const analysisTimeoutRef = useRef(null);\r\n    const [isCameraOn, setIsCameraOn] = useState(false);\r\n    const [analysisResult, setAnalysisResult] = useState({\r\n        detected_class: null,\r\n        state: {\r\n            current_state: \"WAIT_FIRST_NUM\",\r\n            number_1: null,\r\n            operator: null,\r\n            number_2: null,\r\n            result: null,\r\n        }\r\n    });\r\n    const [statusMessage, setStatusMessage] = useState(\"Click 'Start Camera' to begin.\");\r\n    const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n    const [analysisTimer, setAnalysisTimer] = useState(0);\r\n\r\n    // Function to start the camera\r\n    const startCamera = async () => {\r\n        try {\r\n            const stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n            if (videoRef.current) {\r\n                videoRef.current.srcObject = stream;\r\n                setIsCameraOn(true);\r\n                setStatusMessage(\"Please show the first number (0-9).\");\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Error accessing camera:\", err);\r\n            setStatusMessage(\"Camera access denied. Please allow camera permissions.\");\r\n        }\r\n    };\r\n\r\n    // Function to stop the camera\r\n    const stopCamera = () => {\r\n        if (videoRef.current && videoRef.current.srcObject) {\r\n            videoRef.current.srcObject.getTracks().forEach(track => track.stop());\r\n            setIsCameraOn(false);\r\n            setStatusMessage(\"Click 'Start Camera' to begin.\");\r\n        }\r\n        // Stop any ongoing analysis\r\n        stopAnalysisProcess();\r\n    };\r\n\r\n    // Function to stop analysis process\r\n    const stopAnalysisProcess = () => {\r\n        if (analysisIntervalRef.current) {\r\n            clearInterval(analysisIntervalRef.current);\r\n            analysisIntervalRef.current = null;\r\n        }\r\n        if (analysisTimeoutRef.current) {\r\n            clearTimeout(analysisTimeoutRef.current);\r\n            analysisTimeoutRef.current = null;\r\n        }\r\n        setIsAnalyzing(false);\r\n        setAnalysisTimer(0);\r\n    };\r\n\r\n    // Function to manually reset the calculator with cache clearing\r\n    const resetCalculator = async () => {\r\n        // Stop any ongoing analysis\r\n        stopAnalysisProcess();\r\n\r\n        // Clear frontend cache/state\r\n        setAnalysisResult({\r\n            detected_class: null,\r\n            state: {\r\n                current_state: \"WAIT_FIRST_NUM\",\r\n                number_1: null,\r\n                operator: null,\r\n                number_2: null,\r\n                result: null,\r\n            }\r\n        });\r\n        setStatusMessage(\"Calculator reset. Please show the first number.\");\r\n\r\n        // Clear backend cache by calling reset endpoint\r\n        try {\r\n            await fetch('http://localhost:8001/api/reset', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n            });\r\n            console.log(\"Backend cache cleared successfully\");\r\n        } catch (error) {\r\n            console.error(\"Failed to clear backend cache:\", error);\r\n            // Continue with frontend reset even if backend reset fails\r\n        }\r\n    };\r\n\r\n    // Function to perform single frame analysis\r\n    const performSingleAnalysis = useCallback(async () => {\r\n        if (!videoRef.current || !videoRef.current.srcObject) return null;\r\n\r\n        const canvas = canvasRef.current;\r\n        const video = videoRef.current;\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        const context = canvas.getContext('2d');\r\n        context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n\r\n        return new Promise((resolve) => {\r\n            canvas.toBlob(async (blob) => {\r\n                const formData = new FormData();\r\n                formData.append('file', blob, 'frame.jpg');\r\n\r\n                try {\r\n                    const response = await fetch('http://localhost:8001/api/detect', {\r\n                        method: 'POST',\r\n                        body: formData,\r\n                    });\r\n                    const data = await response.json();\r\n                    resolve(data);\r\n                } catch (error) {\r\n                    console.error(\"Analysis failed:\", error);\r\n                    setStatusMessage(\"Analysis failed. Is the backend running?\");\r\n                    resolve(null);\r\n                }\r\n            }, 'image/jpeg');\r\n        });\r\n    }, []);\r\n\r\n    // Function to run analysis for 3 seconds or until gesture detected\r\n    const runAnalysis = useCallback(async () => {\r\n        if (isAnalyzing || !isCameraOn || !videoRef.current || !videoRef.current.srcObject) return;\r\n        \r\n        setIsAnalyzing(true);\r\n        setAnalysisTimer(3);\r\n        \r\n        // Timer countdown display\r\n        const timerInterval = setInterval(() => {\r\n            setAnalysisTimer(prev => {\r\n                if (prev <= 1) {\r\n                    clearInterval(timerInterval);\r\n                    return 0;\r\n                } else {\r\n                    return prev - 1;\r\n                }\r\n            });\r\n        }, 1000);\r\n        \r\n        // Analysis interval - check every 500ms\r\n        analysisIntervalRef.current = setInterval(async () => {\r\n            const result = await performSingleAnalysis();\r\n            \r\n            if (result) {\r\n                setAnalysisResult(result);\r\n                \r\n                // Stop analysis if valid gesture is detected (not 'Undefined' or null)\r\n                if (result.detected_class && result.detected_class !== 'Undefined') {\r\n                    console.log(`Valid gesture detected: ${result.detected_class}. Stopping analysis.`);\r\n                    clearInterval(timerInterval);\r\n                    stopAnalysisProcess();\r\n                    \r\n                    // Handle reset when Start is detected\r\n                    if (result.detected_class === 'Start') {\r\n                        setTimeout(() => {\r\n                            setAnalysisResult({\r\n                                detected_class: null,\r\n                                state: {\r\n                                    current_state: \"WAIT_FIRST_NUM\",\r\n                                    number_1: null,\r\n                                    operator: null,\r\n                                    number_2: null,\r\n                                    result: null,\r\n                                }\r\n                            });\r\n                        }, 1500);\r\n                    }\r\n                    return; // Exit the interval\r\n                }\r\n            }\r\n        }, 500); // Check every 500ms\r\n        \r\n        // Stop analysis after 3 seconds maximum\r\n        analysisTimeoutRef.current = setTimeout(() => {\r\n            console.log(\"3 seconds elapsed. Stopping analysis.\");\r\n            clearInterval(timerInterval);\r\n            stopAnalysisProcess();\r\n        }, 3000);\r\n        \r\n    }, [isAnalyzing, isCameraOn, performSingleAnalysis]);\r\n\r\n    // Helper to update status message based on state\r\n    const updateStatusMessage = useCallback(() => {\r\n        const { state, detected_class } = analysisResult;\r\n        if (!state) return;\r\n\r\n        if (detected_class === 'Start') {\r\n            setStatusMessage(\"System reset! Starting fresh calculation...\");\r\n            return;\r\n        }\r\n        if (detected_class === 'Undefined') {\r\n            setStatusMessage(\"Gesture not recognized. Please try again.\");\r\n            return;\r\n        }\r\n\r\n        switch (state.current_state) {\r\n            case \"WAIT_FIRST_NUM\":\r\n                setStatusMessage(\"Please show the first number (0-9).\");\r\n                break;\r\n            case \"WAIT_OPERATOR\":\r\n                setStatusMessage(`Got it: ${state.number_1}. Now show an operator.`);\r\n                break;\r\n            case \"WAIT_SECOND_NUM\":\r\n                setStatusMessage(`OK: ${state.number_1} ${state.operator}. Now show the second number.`);\r\n                break;\r\n            case \"SHOWING_RESULT\":\r\n                setStatusMessage(`Calculation complete! Result: ${state.result}. Show 'Start' to reset.`);\r\n                break;\r\n            default:\r\n                setStatusMessage(\"Ready to start.\");\r\n        }\r\n    }, [analysisResult]);\r\n\r\n    useEffect(() => {\r\n        updateStatusMessage();\r\n    }, [analysisResult, updateStatusMessage]);\r\n\r\n    // Helper to get dynamic class for UI boxes\r\n    const getBoxClass = (boxName) => {\r\n        const currentState = analysisResult.state?.current_state;\r\n        let isActive = false;\r\n        if (boxName === 'number_1' && currentState === 'WAIT_FIRST_NUM') isActive = true;\r\n        if (boxName === 'operator' && currentState === 'WAIT_OPERATOR') isActive = true;\r\n        if (boxName === 'number_2' && currentState === 'WAIT_SECOND_NUM') isActive = true;\r\n        return `p-4 rounded-lg transition-all text-center ${isActive ? 'active-box' : 'bg-gray-800'}`;\r\n    };\r\n    \r\n    // Cleanup camera and intervals on component unmount\r\n    useEffect(() => {\r\n        const videoElement = videoRef.current;\r\n        \r\n        return () => {\r\n            if (videoElement && videoElement.srcObject) {\r\n                videoElement.srcObject.getTracks().forEach(track => track.stop());\r\n            }\r\n            // Clean up intervals and timeouts\r\n            if (analysisIntervalRef.current) {\r\n                clearInterval(analysisIntervalRef.current);\r\n            }\r\n            if (analysisTimeoutRef.current) {\r\n                clearTimeout(analysisTimeoutRef.current);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"w-full max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8 animate-fade-in\">\r\n            {/* Left Panel: Camera and Controls */}\r\n            <div className=\"flex flex-col items-center bg-gray-800 p-6 rounded-2xl shadow-lg\">\r\n                <div className=\"w-full flex justify-between items-center mb-4\">\r\n                    <h1 className=\"text-2xl font-bold\">YOLOv11 Calculator</h1>\r\n                    <button onClick={() => onNavigate('home')} className=\"text-sm text-blue-400 hover:text-blue-300\">\r\n                        &larr; Back to Home\r\n                    </button>\r\n                </div>\r\n                <div className=\"w-full aspect-video bg-black rounded-lg overflow-hidden mb-4\">\r\n                    <video ref={videoRef} autoPlay playsInline className=\"w-full h-full object-cover\"></video>\r\n                    <canvas ref={canvasRef} className=\"hidden\"></canvas>\r\n                </div>\r\n                <div className=\"flex flex-wrap gap-2 justify-center\">\r\n                    <button onClick={isCameraOn ? stopCamera : startCamera} className=\"px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors\">\r\n                        {isCameraOn ? 'Stop Camera' : 'Start Camera'}\r\n                    </button>\r\n                    <button \r\n                        onClick={runAnalysis} \r\n                        disabled={!isCameraOn || isAnalyzing} \r\n                        className=\"px-6 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-semibold transition-colors disabled:bg-gray-500\"\r\n                    >\r\n                        {isAnalyzing ? `Analyzing... ${analysisTimer}s` : 'Run Analysis (3s)'}\r\n                    </button>\r\n                    <button onClick={resetCalculator} className=\"px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-semibold transition-colors\">\r\n                        Reset & Clear Cache\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Analysis indicator */}\r\n                {isAnalyzing && (\r\n                    <div className=\"mt-3 text-center\">\r\n                        <div className=\"flex items-center justify-center space-x-2\">\r\n                            <div className=\"w-4 h-4 bg-green-500 rounded-full animate-pulse\"></div>\r\n                            <p className=\"text-sm text-green-400\">\r\n                                Detecting gestures... {analysisTimer}s remaining\r\n                            </p>\r\n                        </div>\r\n                        <div className=\"mt-2 w-full bg-gray-600 rounded-full h-2\">\r\n                            <div \r\n                                className=\"bg-green-500 h-2 rounded-full transition-all duration-1000\" \r\n                                style={{ width: `${((3 - analysisTimer) / 3) * 100}%` }}\r\n                            ></div>\r\n                        </div>\r\n                        <p className=\"text-xs text-gray-400 mt-1\">\r\n                            Analysis will stop when gesture is detected\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Right Panel: Results */}\r\n            <div className=\"flex flex-col justify-center bg-gray-800 p-6 rounded-2xl shadow-lg\">\r\n                <h2 className=\"text-2xl font-bold mb-4 text-center\">Calculation</h2>\r\n                <div className=\"status-message bg-gray-700 p-3 rounded-lg mb-6\">\r\n                    <p className=\"text-lg text-center font-mono\">{statusMessage}</p>\r\n                </div>\r\n                <div className=\"calculation-display flex items-center justify-center space-x-2 md:space-x-4 text-3xl md:text-5xl font-mono mb-6\">\r\n                    <span className={getBoxClass('number_1')}>{analysisResult.state?.number_1 ?? '_'}</span>\r\n                    <span className={getBoxClass('operator')}>{analysisResult.state?.operator ?? '_'}</span>\r\n                    <span className={getBoxClass('number_2')}>{analysisResult.state?.number_2 ?? '_'}</span>\r\n                    <span className=\"mx-2\">=</span>\r\n                    <span className=\"p-4 rounded-lg bg-gray-800 text-center\">{analysisResult.state?.result ?? '_'}</span>\r\n                </div>\r\n                <div className=\"bg-gray-700 p-3 rounded-lg text-center\">\r\n                    <p>Last Detected: <span className=\"font-bold text-green-400\">{analysisResult.detected_class ?? 'None'}</span></p>\r\n                    <p>Current State: <span className=\"font-bold text-yellow-400\">{analysisResult.state?.current_state ?? 'N/A'}</span></p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CalculatorPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}